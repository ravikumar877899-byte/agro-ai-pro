{% extends "base.html" %}

{% block content %}
<div style="margin-bottom: 2rem; display: flex; justify-content: space-between; align-items: center;">
    <div>
        <h1>Analytical Diagnosis Reports</h1>
        <p style="color: var(--text-secondary);">Comprehensive log of all AI-driven crop examinations.</p>
    </div>
    <button class="btn" onclick="window.print()" style="background: #607d8b;">
        <i class="fa-solid fa-file-export"></i> Export All Data
    </button>
</div>

<div class="card">
    <table style="width: 100%; border-collapse: collapse;">
        <thead>
            <tr style="text-align: left; border-bottom: 2px solid #eee;">
                <th style="padding: 1.5rem 1rem;">Diagnosis ID</th>
                <th style="padding: 1.5rem 1rem;">Capture Source</th>
                <th style="padding: 1.5rem 1rem;">Crop & Disease Classification</th>
                <th style="padding: 1.5rem 1rem;">Precision Accuracy</th>
                <th style="padding: 1.5rem 1rem;">Timestamp</th>
                <th style="padding: 1.5rem 1rem;">Status</th>
            </tr>
        </thead>
        <tbody>
            {% for record in records %}
            <tr style="border-bottom: 1px solid #f5f5f5; transition: background 0.2s;">
                <td style="padding: 1.2rem 1rem;"><strong>#ID-{{ record[0] }}</strong></td>
                <td style="padding: 1.2rem 1rem;">
                    <img src="{{ url_for('static', filename='uploads/' + record[1]) }}" alt="Leaf"
                        style="width: 45px; height: 45px; border-radius: 8px; object-fit: cover; border: 1px solid #ddd;">
                </td>
                <td style="padding: 1.2rem 1rem;">
                    <div style="font-weight: 600;">{{ record[2].split('___')[0].replace('_', ' ') }}</div>
                    <div style="font-size: 0.85rem; color: #d32f2f;">{{ record[2].split('___')[1].replace('_', ' ') }}
                    </div>
                </td>
                <td style="padding: 1.2rem 1rem;">
                    <span
                        style="padding: 5px 10px; background: #e8f5e9; color: #2e7d32; border-radius: 12px; font-weight: bold; font-size: 0.85rem;">
                        {{ record[3] }}%
                    </span>
                </td>
                <td style="padding: 1.2rem 1rem; font-size: 0.9rem; color: #666;">
                    {{ record[5].split('.')[0] }}
                </td>
                <td style="padding: 1.2rem 1rem;">
                    <span style="color: #4caf50; font-weight: bold; font-size: 0.8rem;">
                        <i class="fa-solid fa-circle-check"></i> VERIFIED
                    </span>
                </td>
            </tr>
            {% endfor %}
            {% if not records %}
            <tr>
                <td colspan="6" style="text-align: center; padding: 4rem; color: #999;">
                    <i class="fa-solid fa-database"
                        style="font-size: 3rem; margin-bottom: 1rem; display: block; opacity: 0.3;"></i>
                    Analytical records are currently empty.
                </td>
            </tr>
            {% endif %}
        </tbody>
    </table>
</div>

<div style="margin-top: 2rem; display: flex; gap: 1rem;">
    <div class="card" style="flex: 1; text-align: center; padding: 1.5rem; background: #fffde7;">
        <i class="fa-solid fa-triangle-exclamation" style="color: #fbc02d; font-size: 1.5rem; margin-bottom: 10px;"></i>
        <h4>Critical Alerts: 0</h4>
        <p style="font-size: 0.85rem; color: #666; margin-top: 5px;">No severe outbreaks detected in recent scans.</p>
    </div>
    <div class="card" style="flex: 1; text-align: center; padding: 1.5rem; background: #e3f2fd;">
        <i class="fa-solid fa-shield-virus" style="color: #1e88e5; font-size: 1.5rem; margin-bottom: 10px;"></i>
        <h4>Protected Crops: {{ records|length }}</h4>
        <p style="font-size: 0.85rem; color: #666; margin-top: 5px;">Total unique IDs monitored by AgroAI.</p>
    </div>
</div>
{% endblock %}